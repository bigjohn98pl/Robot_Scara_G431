close all, clc;
syms theta1 theta2 X Y
a1 = 200;
a2 = 130;
 
eqn = [a1*cos(theta1)+a2*cos(theta1+theta2)-X==0, a1*sin(theta1)+a2*sin(theta1+theta2)-Y==0];
sol=solve(eqn,theta1,theta2);
J1 = simplify(sol.theta1);
J2 = simplify(sol.theta2);
pretty(J1);
pretty(J2);

%% -----------------------------------------------------------------
XY_in   = [330,0]
J       = kin_odwrotna(XY_in);
J_deg   = rad2deg([J])
J_rad   = deg2rad([0,140])
XY_out  = kin_prosta(J_rad,[a1,a2])
round(XY_out) == XY_in
%% -----------------------------------------------------------------
%Funkcjie kinematyki prostej i odwrotnej
function J = kin_odwrotna(u)
X=u(1);
Y=u(2);
a1 = 200;
a2 = 130;

%J(1) =  2*atan((400*Y + (- X^4 - 2*X^2*Y^2 + 113800*X^2 - Y^4 + 113800*Y^2 - 533610000)^(1/2))/(X^2 + 400*X + Y^2 + 23100));
%J(1) =  2*atan((400*Y - (- X^4 - 2*X^2*Y^2 + 113800*X^2 - Y^4 + 113800*Y^2 - 533610000)^(1/2))/(X^2 + 400*X + Y^2 + 23100));
%J(1) =  2*atan((400*Y - (4900*(-(X^2 + Y^2 - 4900)*(X^2 + Y^2 - 108900))^(1/2))/(X^2 + Y^2 - 4900) + (X^2*(-(X^2 + Y^2 - 4900)*(X^2 + Y^2 - 108900))^(1/2))/(X^2 + Y^2 - 4900) + (Y^2*(-(X^2 + Y^2 - 4900)*(X^2 + Y^2 - 108900))^(1/2))/(X^2 + Y^2 - 4900))/(X^2 + 400*X + Y^2 + 23100));
%J(1) =  2*atan((400*Y + (4900*(-(X^2 + Y^2 - 4900)*(X^2 + Y^2 -108900))^(1/2))/(X^2 + Y^2 - 4900) - (X^2*(-(X^2 + Y^2 - 4900)*(X^2 + Y^2 - 108900))^(1/2))/(X^2 + Y^2 - 4900) - (Y^2*(-(X^2 + Y^2 - 4900)*(X^2 + Y^2 - 108900))^(1/2))/(X^2 + Y^2 - 4900))/(X^2 + 400*X + Y^2 + 23100));
 
J(2) = -2*atan((-(X^2 + Y^2 - 4900)*(X^2 + Y^2 - 108900))^(1/2)/(X^2 + Y^2 - 4900));
%J(2) =  2*atan((-(X^2 + Y^2 - 4900)*(X^2 + Y^2 - 108900))^(1/2)/(X^2 + Y^2 - 4900));

J(1) =   2*atan((400*Y - (- X*X*X*X - 2*X*X*Y*Y + 113800*X*X - Y*Y*Y*Y + 113800*Y*Y - 533610000)^(1/2))/(X*X + 400*X + Y*Y + 23100));
%J(2) =   2*atan((-(X*X + Y*Y - 4900)*(X*X + Y*Y - 108900))^(1/2)/(X*X + Y*Y - 4900));

%J(2) = acos( ( (X*X)+(Y*Y) - (a1*a1)-(a2*a2) ) / (2*a1*a2) );
%J(1) = asin(a2*sin(J(2))/sqrt(X*X+Y*Y)) + atan(Y/X);
end

function [XY] = kin_prosta(J,L)
	X = L(1)*cos(J(1))+L(2)*cos(J(1)+J(2));
	Y = L(1)*sin(J(1))+L(2)*sin(J(1)+J(2));
    XY = [X,Y];
end